<!DOCTYPE html>
<!-- saved from url=(0067)https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations -->
<html class="js hasSidebar hasPageActions hasBreadcrumb  noTouch" lang="en-us" dir="ltr"><script async="" src="./Migrations_files/analytics.js.descarga"></script><script type="text/javascript">window["_gaUserPrefs"] = { ioo : function() { return true; } }</script><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script src="./Migrations_files/getid.js.descarga"></script>
	
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta property="og:title" content="ASP.NET Core MVC with EF Core - Migrations - 4 of 10">
	<meta property="og:image" content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png">

	<meta name="twitter:card" content="summary">
	<meta name="twitter:site" content="@docsmsft">
	<meta name="twitter:title" content="ASP.NET Core MVC with EF Core - Migrations - 4 of 10">
	<meta name="twitter:description" content="In this tutorial, you start using the EF Core migrations feature for managing data model changes in an ASP.NET Core MVC application.">
	<meta name="twitter:image" content="https://docs.microsoft.com/_themes/docs.theme/master/en-us/_themes/images/microsoft-header.png">
	<meta name="twitter:image:alt" content="Microsoft Logo">

		<meta name="breadcrumb_path" content="/aspnet/breadcrumb/toc.json">
<meta name="ms.assetid" content="81f6c9c2-a819-4f3a-97a4-4b0503b56c26">
<meta name="author" content="tdykstra">
<meta name="description" content="In this tutorial, you start using the EF Core migrations feature for managing data model changes in an ASP.NET Core MVC application.">
<meta name="ms.author" content="tdykstra">
<meta name="manager" content="wpickett">
<meta name="uid" content="data/ef-mvc/migrations">
<meta name="keywords" content="ASP.NET Core, Entity Framework Core, migrations">
<meta name="ms.topic" content="get-started-article">
<meta name="ms.date" content="03/15/2017">
<meta name="ms.technology" content="aspnet">
<meta name="ms.prod" content="asp.net-core">
<meta name="search.ms_sitename" content="Docs">
<meta name="search.ms_docsetname" content="aspnet-core-conceptual">
<meta name="version" content="0">
<meta name="locale" content="en-us">
<meta name="site_name" content="Docs">
<meta name="search.ms_product" content="MSDN">
<meta name="depot_name" content="MSDN.aspnet-core-conceptual">
<meta name="updated_at" content="2017-08-25 10:35 PM">
<meta name="gitcommit" content="https://github.com/aspnet/Docs/blob/fa4fc026269ef5452328d3d5826f63482801ac4d/aspnetcore/data/ef-mvc/migrations.md">
<meta name="original_content_git_url" content="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/migrations.md">
<meta name="document_id" content="e56e675b-5964-a75b-7e45-6f6d1a607e65">
<meta name="pagetype" content="Conceptual">
<meta name="toc_rel" content="../../toc.json">
<meta name="pdf_url_template" content="https://docs.microsoft.com/pdfstore/en-us/MSDN.aspnet-core-conceptual/{branchName}{pdfName}">
<meta name="word_count" content="1605">

	<meta name="scope" content="ASP.NET Core">
<link href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations" rel="canonical">
	<title>ASP.NET Core MVC with EF Core - Migrations - 4 of 10 | Microsoft Docs</title>

	<link rel="stylesheet" href="./Migrations_files/b11234fb1603062af431.site.css">
	<link rel="stylesheet" href="./Migrations_files/b11234fb1603062af431.conceptual.css">

	<script>
	var msDocs = {
		data:{
			contentLocale: 'en-us',
			contentDir: 'ltr',
			userLocale: 'en-us',
			userDir: 'ltr',
			pathToTheme: '/_themes/docs.theme/master/en-us/_themes/',
			pageTemplate: 'Conceptual',
			brand: ''
		},
		functions:{},
		settings:{
			extendBreadcrumb: false
		}
	};
	if (!('Promise' in window && 'resolve' in window.Promise && 'reject' in window.Promise && 'all' in window.Promise && 'race' in window.Promise)) {
		document.write('<script src="/_themes/docs.theme/master/en-us/_themes/global/js/bluebird.min.js"><\/script>');
	}
	</script>

	<!--[if lt IE 9]>
		<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-1.12.4.min.js"></script>
		<script src="/_themes/docs.theme/master/en-us/_themes/global/js/polyfills/all.js"></script>
	<![endif]-->
	<!--[if gte IE 9]><!-->
		<script src="./Migrations_files/jquery-2.2.4.min.js.descarga"></script>
	<!--<![endif]-->
	<script>window.jQuery || document.write('<script src="/_themes/docs.theme/master/en-us/_themes/global/js/jquery/jquery-1.12.4.min.js"><\/script>')</script>
	<script src="./Migrations_files/global.min.js.descarga"></script><style></style><meta name="rating.locale" content="en-us"><script src="./Migrations_files/open-rating.entry.min.js.descarga" async="" defer=""></script><script src="./Migrations_files/jsll-4.2.1.js.descarga" async="" defer=""></script>
<meta name="ms.documentid" content="e56e675b-5964-a75b-7e45-6f6d1a607e65"><meta name="ms.contentlang" content="en-us"><meta name="ms.publishtime" content="2017-08-25 10:35 PM"><meta name="ms.giturl" content="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/migrations.md"><meta name="ms.sitename" content="Docs"><meta name="ms.gitcommit" content="https://github.com/aspnet/Docs/blob/fa4fc026269ef5452328d3d5826f63482801ac4d/aspnetcore/data/ef-mvc/migrations.md"><meta name="ms.depotname" content="MSDN.aspnet-core-conceptual"><meta name="ms.opspagetype" content="Conceptual"><meta name="ms.locale" content="en-us"><meta name="ms.lang" content="en"><meta name="ms.loc" content="us"><meta name="ms.theme" content="light"><meta name="ms.contentsource" content="OP"><meta name="ms.pvid" content="E05FA7FA-51A5-4A51-AB75-557336DBE273"><meta name="ms.perf.timing" content=",,0,0,0,5,5,9,15,298,299,,,,"><script type="text/javascript" charset="utf-8" async="" src="./Migrations_files/2.b11234fb1603062af431.2.js.descarga"></script><link rel="stylesheet" href="./Migrations_files/38-3b7d44"><script async="" src="./Migrations_files/t.js.descarga"></script><script src="./Migrations_files/49-945edd" defer=""></script><script src="./Migrations_files/meversion" defer=""></script><script async="" src="./Migrations_files/t.js(1).descarga"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="/_chrome/commenting/master/open-commenting.ui.v1.0.2-7-g1b78816.master.min.js" src="./Migrations_files/open-commenting.ui.v1.0.2-7-g1b78816.master.min.js.descarga"></script><script async="" src="./Migrations_files/t.js(2).descarga"></script><style type="text/css">.or-o, .or-so {
    margin: 0;
    padding: 0;
    height: auto;
    width: auto;
    position: relative;
    float: none;
    border: none;
    border-radius: 0;
    outline: none;
    background: none;
    box-sizing: border-box;
    font: 13px 'Segoe UI', Frutiger, 'Frutiger Linotype', 'Dejavu Sans', 'Helvetica Neue', Arial, sans-serif;
    letter-spacing: normal;
    text-transform: none;
    border-spacing: 0;
    border-collapse: collapse;
    transform: none;
    transition: none;
    animation: none;
}
.or-o:before, .or-o:after, .or-so:before, .or-so:after {
    content: none;
}
.or-e-0 {
    transition: none !important;
}
.or-f {
    padding: 1px;
}
.or-f::-moz-focus-inner {
    border: none;
    padding: 0;
}
.or-lw {
    clear: both;
}
h1, h2 {}
h1.or-t, h2.or-t {
    font-weight: lighter;
}
h1.or-t {
    font-size: 40px;
}
h2.or-t {
    font-size: 30px;
}
h3.or-t {
    font-size: 20px;
}
h4.or-t {
    font-size: 17px;
}
.or-b {
    cursor: pointer;
}
.or-b>.or-c {
    display: inline-block;
    padding: 4px 25px;
    width: 100%;
    height: 100%;
}
.or-b:active {
    transform: scale(0.98, 0.95);
}
.or-b[disabled] {
    cursor: default;
}
.or-b[disabled]:active {
    transform: none;
}
.or-g {
    display: inline-block;
    line-height: 0;
}
.or-l {
    cursor: pointer;
    padding: 5px 1px;
    vertical-align: baseline;
}
.or-l>.or-c {
    text-decoration: underline;
}
.or-a {
    cursor: pointer;
}
.or-a>.or-c {
    display: inline-block;
    padding: 8px;
    width: 100%;
    height: 100%;
}
.or-v {
    cursor: pointer;
    padding-bottom: 2px;
    /* For IE :active propagation BUG Fix */
}
.or-v>span {
    display: inline-block;
}
.or-v>input[type=checkbox] {
    -moz-appearance: checkbox-container;
    width: 0;
    height: 0;
    opacity: 0;
}
.or-v>input[type=checkbox]+span, .or-v>input[type=checkbox]+span+span {
    position: absolute;
    width: 20px;
    height: 20px;
    overflow: hidden;
}
.or-v>input[type=checkbox]+span+span {
    opacity: 0;
}
.or-v>input[type=checkbox]:checked+span+span {
    opacity: 1;
}
.or-v>span:last-child {
    margin: 0 0 0 25px;
    line-height: 19px;
}
.or-v:after {
    content: '';
    display: inline-block;
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    opacity: 0;
}
.or-pc[dir=rtl] .or-v>span:last-child {
    margin: 0 25px 0 0;
}
.or-x {
    resize: none;
    padding: 5px;
}
.or-c-mf {
    padding: 10px;
}
.or-c-mf.or-e-fi {
    transition: opacity 0.1s linear;
}
.or-c-mf.or-e-fo {
    transition: opacity 0.75s linear;
}
.or-c-pf {
    padding: 7px;
    max-height: 100%;
    overflow: auto;
}
.or-c-pf>.or-a {
    padding: 0;
    position: absolute;
    right: 0;
    top: 0;
    line-height: 0;
    width: 20px;
    height: 20px;
}
.or-c-pf>.or-a.or-f.or-k {
    outline: none;
}
.or-c-pf>.or-a>.or-c.or-g {
    padding: 0;
}
.or-c-pf>.or-a>.or-c.or-g>svg {
    stroke-width: 1px;
}
.or-c-pf.or-e-fi, .or-c-pf.or-e-fo {
    transition: opacity 0.1s linear;
}
.or-c-pf>.or-lw {
    overflow: hidden;
    padding: 3px;
}
.or-c-pf>.or-lw.or-e-h.or-e-w.or-e-fi {
    transition: height 0.167s cubic-bezier(0.1, 0.9, 0.2, 1.0),
                    width 0.167s cubic-bezier(0.1, 0.9, 0.2, 1.0),
                    opacity 0.1s linear 0.167s;
}
.or-pc[dir=rtl] .or-c-pf>.or-a {
    left: 0;
    right: initial;
}
.or-c-md {
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    display: -ms-flexbox;
    display: flex;
    -ms-flex-direction: column;
        flex-direction: column;
    -ms-flex-align: center;
        align-items: center;
    -ms-flex-pack: center;
        justify-content: center;
}
.or-c-md>.or-c {
    overflow: auto;
}
.or-c-md>.or-c.or-e-fi.or-e-t {
    transition: opacity 0.167s linear, transform 0.367s cubic-bezier(0.1, 0.9, 0.2, 1.0);
}
.or-c-md>.or-c.or-e-fo.or-e-t {
    transition: opacity 0.1s linear, transform 0.1s linear;
}
.or-c-v h3.or-t {
    font-size: 13px;
    margin: 0 18px 5px 1px;
}
.or-c-v>table.or-lw {
    table-layout: fixed;
}
.or-c-v>table.or-lw td {
    width: 50%;
}
.or-c-v>table.or-lw td>.or-b {
    width: 100%;
}
.or-c-v>table.or-lw td:first-child {
    padding-right: 1px;
}
.or-c-v>table.or-lw td:last-child {
    padding-left: 1px;
}
.or-pc[dir=rtl] .or-c-v h3.or-t {
    margin: 0 1px 5px 18px;
}
.or-pc[dir=rtl] .or-c-v>table.or-lw td:first-child {
    border: none;
    border-left: 2px transparent solid;
}
.or-c-f {
    width: 235px;
    max-width: 100%;
}
.or-c-f h3.or-t {
    font-size: 13px;
    font-weight: bold;
}
.or-c-f .or-v, .or-c-f .or-x, .or-c-f>.or-b {
    display: block;
}
.or-c-f .or-v {
    margin: 3px 0 0 0;
}
.or-c-f .or-x {
    width: 100%;
    height: 75px;
}
.or-c-f>.or-lw {
    margin: 3px 0 0 0;
}
.or-c-f>.or-lw>.or-t {
    margin: 0 18px 0 0;
}
.or-c-f>.or-lw.or-e-h.or-e-w.or-e-fi {
    transition: height 0.167s cubic-bezier(0.1, 0.9, 0.2, 1.0),
                    width 0.167s cubic-bezier(0.1, 0.9, 0.2, 1.0),
                    opacity 0.167s linear;
}
.or-c-f>h3.or-t {
    margin: 7px 0 5px 1px;
}
.or-c-f>.or-b {
    float: right;
    margin: 4px -1px 0 0;
}
.or-pc[dir=rtl] .or-c-f {}
.or-pc[dir=rtl] .or-c-f>h3.or-t {
    margin: 7px 1px 5px 0;
}
.or-pc[dir=rtl] .or-c-f>.or-lw>.or-t {
    margin: 0 0 0 18px;
}
.or-pc[dir=rtl] .or-c-f>.or-b {
    float: left;
    margin: 4px 0 0 -1px;
}
.or-c-t h3.or-t {
    font-size: 13px;
}
.or-c-pf .or-c-t h3.or-t {
    margin: 3px 18px 0 0;
}
.or-pc[dir=rtl] .or-c-pf .or-c-t h3.or-t {
    margin: 3px 0 0 18px;
}
.or-c-mv svg {
    width: 12px;
    height: 12px;
    stroke-width: 1px;
}
.or-c-mv>.or-c {
    padding: 3px 20px 5px 17px;
}
.or-c-mv>.or-c>span {
    vertical-align: middle;
}
.or-c-mv>.or-c>.or-t {
    color: inherit;
    margin-left: 2px;
}
.or-c-mv.or-e-fi {
    transition: opacity 0.1s linear;
}
.or-pc[dir=rtl] .or-c-mv>.or-c {
    padding: 3px 17px 5px 20px;
}
.or-pc[dir=rtl] .or-c-mv>.or-c>.or-t {
    margin: 0 2px 0 0;
}
.or-t-ml .or-f {}
.or-t-ml .or-f.or-k {
    outline: 2px black solid;
}
.or-t-ml .or-t {
    color: black;
}
.or-t-ml .or-b {}
.or-t-ml .or-b, .or-t-ml .or-b:hover, .or-t-ml .or-b:active {
    background: none;
}
.or-t-ml .or-b>.or-c {
    color: white;
    stroke: white;
    fill: white;
    background: #0078d7;
    border: 2px transparent solid;
}
.or-t-ml .or-b:hover>.or-c {
    border-color: rgba(0, 0, 0, 0.4);
}
.or-t-ml .or-b:active>.or-c {
    color: black;
    stroke: black;
    fill: black;
    background: #999999;
    border-color: transparent;
}
.or-t-ml .or-b[disabled]>.or-c, .or-t-ml .or-b[disabled]:hover>.or-c {
    color: rgba(0, 0, 0, 0.4);
    stroke: rgba(0, 0, 0, 0.4);
    fill: rgba(0, 0, 0, 0.4);
    background: rgba(0, 0, 0, 0.2);
    border-color: transparent;
}
.or-t-ml .or-l {}
.or-t-ml .or-l, .or-t-ml .or-l:hover, .or-t-ml .or-l:active {
    background: none;
}
.or-t-ml .or-l>.or-c {
    color: #0078d7;
}
.or-t-ml .or-l:hover>.or-c {
    color: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-l:active>.or-c {
    color: rgba(0, 0, 0, 0.4);
}
.or-t-ml .or-a {}
.or-t-ml .or-a, .or-t-ml .or-a:hover, .or-t-ml .or-a:active {
    background: none;
}
.or-t-ml .or-a>.or-c {
    color: black;
    background: transparent;
}
.or-t-ml .or-a:hover>.or-c {
    background: rgba(0, 0, 0, 0.1);
}
.or-t-ml .or-a:active>.or-c {
    background: rgba(0, 0, 0, 0.2);
}
.or-t-ml .or-v {}
.or-t-ml .or-v>input[type=checkbox] {}
.or-t-ml .or-v>input[type=checkbox]+span {
    border: 2px solid rgba(0, 0, 0, 0.4);
    background: none;
}
.or-t-ml .or-v>input[type=checkbox]+span+span>svg {
    stroke: white;
    stroke-width: 1.5px;
    fill: transparent;
}
.or-t-ml .or-v:hover>input[type=checkbox]+span, .or-t-ml .or-v:hover>input[type=checkbox]:checked+span {
    border-color: black;
}
.or-t-ml .or-v:active>input[type=checkbox]+span, .or-t-ml .or-v>input[type=checkbox]:checked+span, .or-t-ml .or-v:active>input[type=checkbox]:checked+span {
    border-color: transparent;
}
.or-t-ml .or-v:active>input[type=checkbox]+span, .or-t-ml .or-v:active>input[type=checkbox]:checked+span {
    background: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-v>input[type=checkbox]:checked+span {
    background: #0078d7;
}
.or-t-ml .or-x {
    color: black;
    background: rgba(255, 255, 255, 0.4);
    border: 2px rgba(0, 0, 0, 0.4) solid;
}
.or-t-ml .or-x:hover {
    background: rgba(255, 255, 255, 0.6);
    border-color: #171717;
}
.or-t-ml .or-x:active, .or-t-ml .or-x:focus {
    color: black;
    background: white;
    border-color: #0078d7;
}
.or-t-ml .or-x:active::-webkit-input-placeholder, .or-t-ml .or-x:focus::-webkit-input-placeholder {
    color: rgba(0, 0, 0, 0.4);
}
.or-t-ml .or-x:active:-ms-input-placeholder, .or-t-ml .or-x:focus:-ms-input-placeholder {
    color: rgba(0, 0, 0, 0.4);
}
.or-t-ml .or-x:active::placeholder, .or-t-ml .or-x:focus::placeholder {
    color: rgba(0, 0, 0, 0.4);
}
.or-t-ml .or-x::-webkit-input-placeholder {
    color: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-x:-ms-input-placeholder {
    color: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-x::placeholder {
    color: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-c-pf, .or-t-ml .or-c-mf {
    border: 1px rgba(133, 133, 133, 0.4) solid;
    background: white;
}
.or-t-ml .or-c-pf {}
.or-t-ml .or-c-pf>.or-a {}
.or-t-ml .or-c-pf>.or-a.or-f.or-k:after {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    right: 0;
    bottom: 0;
    border: 2px black solid;
}
.or-t-ml .or-c-pf>.or-a>.or-c.or-g>svg {
    stroke: rgba(0, 0, 0, 0.6);
}
.or-t-ml .or-c-pf>.or-a:hover>.or-c.or-g>svg {
    stroke: #c80000;
}
.or-t-ml .or-c-pf>.or-a:active>.or-c.or-g>svg {
    stroke: #8c0000;
}
.or-t-ml .or-c-md {
    background: rgba(255, 255, 255, 0.6);
}
.or-t-ml .or-c-md>.or-c {
    box-shadow: 0 0 30px rgba(0, 0, 0, 0.05);
}

@media screen and (-ms-high-contrast: active) {
    .or-t-ml .or-b, .or-t-md .or-b {}
    .or-t-ml .or-b>.or-c, .or-t-ml .or-b:active>.or-c, .or-t-md .or-b>.or-c, .or-t-md .or-b:active>.or-c {
        stroke: white;
        fill: white;
    }
    .or-t-ml .or-c-pf>.or-a>.or-c.or-g>svg, .or-t-md .or-c-pf>.or-a>.or-c.or-g>svg {
        stroke: white;
    }
}

@media screen and (-ms-high-contrast: black-on-white) {
    .or-t-ml .or-b, .or-t-md .or-b {}
    .or-t-ml .or-b>.or-c, .or-t-ml .or-b:active>.or-c, .or-t-md .or-b>.or-c, .or-t-md .or-b:active>.or-c {
        stroke: black;
        fill: black;
    }
    .or-t-ml .or-v>input[type=checkbox]+span+span>svg, .or-t-md .or-v>input[type=checkbox]+span+span>svg {
        stroke: black;
    }
    .or-t-ml .or-c-pf>.or-a>.or-c.or-g>svg, .or-t-md .or-c-pf>.or-a>.or-c.or-g>svg {
        stroke: black;
    }
}
</style><style type="text/css">[id='openFeedbackContainer']{ position: fixed; right: 10px; bottom: 10px; }
[id='openFeedbackContainer'][dir='rtl']{ left: 10px; right: initial; }</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="//cdn.livefyre.com/libs/fyre.conv/v3.0.0/livefyre.min.js" src="./Migrations_files/livefyre.min.js.descarga"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="//cdn.livefyre.com/libs/sidenotes/v1.6.0/sidenotes.min.js" src="./Migrations_files/sidenotes.min.js.descarga"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="//cdn.livefyre.com/libs/identity/v1.1.12/simple/javascripts/customprofiles.min.js" src="./Migrations_files/customprofiles.min.js.descarga"></script><link rel="stylesheet" type="text/css" href="./Migrations_files/livefyre_main.css" media="all"><script type="text/javascript" src="./Migrations_files/livefyre_base.js.descarga" async="" defer=""></script><script type="text/javascript" src="./Migrations_files/livefyre_mod_main.js.descarga" async="" defer=""></script><link rel="stylesheet" type="text/css" href="./Migrations_files/block.css" media="all"><link rel="stylesheet" type="text/css" href="./Migrations_files/sp.css" media="all"><script type="text/javascript" src="./Migrations_files/livefyre_mod_editor_main.js.descarga" async="" defer=""></script><style type="text/css" id="fyre-brand-styles-v2">.fyre-lfep2,
.fyre-lfep2 input,
.fyre-lfep2 textarea {
    font-family: ;
}

.fyre-cp-form-btns .fyre-cp-form-back-btn,
.fyre-cp-form-btns .fyre-cp-form-submit-btn {
    background-color: #e86600;
}

.fyre-cp-link-create {
    color: #e86600;
}

p.fyre-profile-user-comments span,
p.fyre-profile-user-likes span {
    color: #e86600;
}

.fyre-profile-comment-footer a {
    color: #e86600;
}

a.fyre-profile-more-link {
    color: #e86600;
}

.fyre-cp-form .fyre-cp-edit-save-msg {
    color: #e86600
}</style></head>

<body lang="en-us" dir="ltr" style="overflow-y: auto;" class="">
	

	<div class="container mainContainer" lang="en-us" dir="ltr" ms.pgarea="body" data-bi-name="body">
		<main role="main" ms.cmpgrp="content" data-bi-name="content">
				<div id="main">

						<h1 id="migrations---ef-core-with-aspnet-core-mvc-tutorial-4-of-10" sourcefile="data/ef-mvc/migrations.md" sourcestartlinenumber="16" sourceendlinenumber="16">Migrations - EF Core with ASP.NET Core MVC tutorial</h1>
						<div class="metadata" ms.cmpgrp="page info" data-bi-name="page info">
							


							<nav id="center-doc-outline" class="doc-outline" ms.cmpgrp="intopic toc" data-bi-name="intopic toc" role="navigation" aria-label="On page navigation">
								<h3>In this article</h3>
							<ol class="lf-text-block lf-block" data-lf-anchor-id="8d54490944a964db3b99b8486513475d:0"><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#introduction-to-migrations">Introduction to migrations</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#entity-framework-core-nuget-packages-for-migrations">Entity Framework Core NuGet packages for migrations</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#change-the-connection-string">Change the connection string</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#create-an-initial-migration">Create an initial migration</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#examine-the-up-and-down-methods">Examine the Up and Down methods</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#examine-the-data-model-snapshot">Examine the data model snapshot</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#apply-the-migration-to-the-database">Apply the migration to the database</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#command-line-interface-cli-vs-package-manager-console-pmc">Command-line interface (CLI) vs. Package Manager Console (PMC)</a></li><li><a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#summary">Summary</a></li><span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8d54490944a964db3b99b8486513475d:0">+
</a>
</span></ol></nav>

						</div>

						<div><div class="content">
<p class="lf-text-block lf-block" data-lf-anchor-id="893f42344621529078004c44d1d160c3:0">By <a href="https://github.com/tdykstra" data-linktype="external">Tom Dykstra</a> and <a href="https://twitter.com/RickAndMSFT" data-linktype="external">Rick Anderson</a><span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="893f42344621529078004c44d1d160c3:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="97e4e9cd14d9605aab4de5424e004345:0">The Contoso University sample web application demonstrates how to create ASP.NET Core MVC web applications using Entity Framework Core and Visual Studio. For information about the tutorial series, see <a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/intro" data-linktype="relative-path">the first tutorial in the series</a>.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="97e4e9cd14d9605aab4de5424e004345:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="2997aec2cfbcf7c809497721422c2bdc:0">In this tutorial, you start using the EF Core migrations feature for managing data model changes. In later tutorials, you'll add more migrations as you change the data model.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="2997aec2cfbcf7c809497721422c2bdc:0">+
</a>
</span></p>
<h2 id="introduction-to-migrations">Introduction to migrations</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="2bfd4e69d739669a330d288761236f78:0">When you develop a new application, your data model changes frequently, and each time the model changes, it gets out of sync with the database. You started these tutorials by configuring the Entity Framework to create the database if it doesn't exist. Then each time you change the data model -- add, remove, or change entity classes or change your DbContext class -- you can delete the database and EF creates a new one that matches the model, and seeds it with test data.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="2bfd4e69d739669a330d288761236f78:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="0395ae4bc5b964a8616dcd464b2127f5:0">This method of keeping the database in sync with the data model works well until you deploy the application to production. When the application is running in production it is usually storing data that you want to keep, and you don't want to lose everything each time you make a change such as adding a new column. The EF Core Migrations feature solves this problem by enabling EF to update the database schema instead of creating  a new database.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0395ae4bc5b964a8616dcd464b2127f5:0">+
</a>
</span></p>
<h2 id="entity-framework-core-nuget-packages-for-migrations">Entity Framework Core NuGet packages for migrations</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="0f948c07d798efb80785dc4ec72a4b52:0">To work with migrations, you can use the <strong>Package Manager Console</strong> (PMC) or the command-line interface (CLI).  These tutorials show how to use CLI commands. Information about the PMC is at <a href="https://docs.microsoft.com/en-us/aspnet/core/data/ef-mvc/migrations#pmc" data-linktype="self-bookmark">the end of this tutorial</a>.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0f948c07d798efb80785dc4ec72a4b52:0">1</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="0fc4acace6ba6ad97b09b807736257d7:0">The EF tools for the command-line interface (CLI) are provided in <a href="https://www.nuget.org/packages/Microsoft.EntityFrameworkCore.Tools.DotNet" data-linktype="external">Microsoft.EntityFrameworkCore.Tools.DotNet</a>. To install this package, add it to the <code>DotNetCliToolReference</code> collection in the <em>.csproj</em> file, as shown. <strong>Note:</strong> You have to install this package by editing the <em>.csproj</em> file; you can't use the <code>install-package</code> command or the package manager GUI. You can edit the <em>.csproj</em> file by right-clicking the project name in <strong>Solution Explorer</strong> and selecting <strong>Edit ContosoUniversity.csproj</strong>.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0fc4acace6ba6ad97b09b807736257d7:0">+
</a>
</span></p>
<div class="codeHeader lang-xml" data-bi-name="code-header"><span class="language">XML</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-xml" data-src="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/intro/samples/cu/ContosoUniversity.csproj" highlight-lines="2" data-bi-name="code-block"><span class="hljs-tag">&lt;<span class="hljs-name">ItemGroup</span>&gt;</span>
<span class="line-highlight">  <span class="hljs-tag">&lt;<span class="hljs-name">DotNetCliToolReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">"Microsoft.EntityFrameworkCore.Tools.DotNet"</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">"2.0.0"</span> /&gt;</span></span>
  <span class="hljs-tag">&lt;<span class="hljs-name">DotNetCliToolReference</span> <span class="hljs-attr">Include</span>=<span class="hljs-string">"Microsoft.VisualStudio.Web.CodeGeneration.Tools"</span> <span class="hljs-attr">Version</span>=<span class="hljs-string">"2.0.0"</span> /&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-name">ItemGroup</span>&gt;</span>
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="8fd52dd59d9c7adb9a6ae44e6708225b:0">(The version numbers in this example were current when the tutorial was written.) <span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8fd52dd59d9c7adb9a6ae44e6708225b:0">2</a>
</span></p>
<h2 id="change-the-connection-string">Change the connection string</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="83dcae6ccfd860aa3129b3c767004b57:0">In the <em>appsettings.json</em> file, change the name of the database in the connection string to ContosoUniversity2 or some other name that you haven't used on the computer you're using.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="83dcae6ccfd860aa3129b3c767004b57:0">+
</a>
</span></p>
<div class="codeHeader lang-json" data-bi-name="code-header"><span class="language">JSON</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-json" data-src="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/intro/samples/cu/appsettings2.json" name="Main" data-bi-name="code-block">{
  <span class="hljs-attr">"ConnectionStrings"</span>: {
    <span class="hljs-attr">"DefaultConnection"</span>: <span class="hljs-string">"Server=(localdb)\\mssqllocaldb;Database=ContosoUniversity2;Trusted_Connection=True;MultipleActiveResultSets=true"</span>
  },
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="0f8029a9c3b9208ab3cbd78869656e71:0">This change sets up the project so that the first migration will create a new database. This isn't required for getting started with migrations, but you'll see later why it's a good idea.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0f8029a9c3b9208ab3cbd78869656e71:0">+
</a>
</span></p>
<div class="NOTE alert"><h5>Note</h5><p class="lf-text-block lf-block" data-lf-anchor-id="09c4ec7cd79962db632daa0ff3868b7f:0">As an alternative to changing the database name, you can delete the database. Use <strong>SQL Server Object Explorer</strong> (SSOX) or the <code>database drop</code> CLI command:<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="09c4ec7cd79962db632daa0ff3868b7f:0">3</a>
</span></p>
<div class="codeHeader lang-console" data-bi-name="code-header"><span class="language">console</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-console" data-bi-name="code-block">dotnet ef database drop
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="0191a02d54bb24bfdba4dde69596cb43:0">The following section explains how to run CLI commands.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0191a02d54bb24bfdba4dde69596cb43:0">+
</a>
</span></p>
</div>
<h2 id="create-an-initial-migration">Create an initial migration</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="04d06c3dc49dd6a13bc8098249226670:0">Save your changes and build the project. Then open a command window and navigate to the project folder. Here's a quick way to do that:<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="04d06c3dc49dd6a13bc8098249226670:0">+
</a>
</span></p>
<ul class="lf-text-block lf-block" data-lf-anchor-id="8fe53c69481d27fc1b09ac454902667a:0">
<li><p>In <strong>Solution Explorer</strong>, right-click the project and choose <strong>Open in File Explorer</strong> from the context menu.</p>
<p><img src="./Migrations_files/open-in-file-explorer.png" alt="Open in File Explorer menu item" data-linktype="relative-path"></p>
</li>
<li><p>Enter "cmd" in the address bar and press Enter.</p>
<p><img src="./Migrations_files/open-command-window.png" alt="Open command window" data-linktype="relative-path"></p>
</li>
<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8fe53c69481d27fc1b09ac454902667a:0">+
</a>
</span></ul>
<p class="lf-text-block lf-block" data-lf-anchor-id="0584ac6cdf982b131808ac6721020347:0">Enter the following command in the command window:<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0584ac6cdf982b131808ac6721020347:0">4</a>
</span></p>
<div class="codeHeader lang-console" data-bi-name="code-header"><span class="language">console</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-console" data-bi-name="code-block">dotnet ef migrations add InitialCreate
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="0f84ac6cff9323e14849ba2723104a57:0">You see output like the following in the command window:<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0f84ac6cff9323e14849ba2723104a57:0">+
</a>
</span></p>
<div class="codeHeader lang-console" data-bi-name="code-header"><span class="language">console</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-console" data-bi-name="code-block">info: Microsoft.AspNetCore.DataProtection.KeyManagement.XmlKeyManager[0]
      User profile is available. Using 'C:\Users\username\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
info: Microsoft.EntityFrameworkCore.Infrastructure[100403]
      Entity Framework Core 2.0.0-rtm-26452 initialized 'SchoolContext' using provider 'Microsoft.EntityFrameworkCore.SqlServer' with options: None
Done. To undo this action, use 'ef migrations remove'
</code></pre><div class="NOTE alert"><h5>Note</h5><p class="lf-text-block lf-block" data-lf-anchor-id="5e92018a54a4816b486997d37a293b63:0">If you see an error message <em>No executable found matching command "dotnet-ef"</em>, see <a href="http://thedatafarm.com/data-access/no-executable-found-matching-command-dotnet-ef/" data-linktype="external">this blog post</a> for help troubleshooting.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="5e92018a54a4816b486997d37a293b63:0">+
</a>
</span></p>
</div>
<p class="lf-text-block lf-block" data-lf-anchor-id="8fe43c2c569de7df3a0c9c0f0b235ef2:0">If you see an error message "<em>cannot access the file ... ContosoUniversity.dll because it is being used by another process.</em>", find the IIS Express icon in the Windows System Tray, and right-click it, then click <strong>ContosoUniversity &gt; Stop Site</strong>.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8fe43c2c569de7df3a0c9c0f0b235ef2:0">+
</a>
</span></p>
<h2 id="examine-the-up-and-down-methods">Examine the Up and Down methods</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="8fc42c6cdd9d64db1309e84f6100035f:0">When you executed the <code>migrations add</code> command, EF generated the code that will create the database from scratch. This code is in the <em>Migrations</em> folder, in the file named <em>&lt;timestamp&gt;_InitialCreate.cs</em>. The <code>Up</code> method of the <code>InitialCreate</code> class creates the database tables that correspond to the data model entity sets, and the <code>Down</code> method deletes them, as shown in the following example.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8fc42c6cdd9d64db1309e84f6100035f:0">3</a>
</span></p>
<div class="codeHeader lang-csharp" data-bi-name="code-header"><span class="language">C#</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-csharp" data-src="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/intro/samples/cu/Migrations/20170215220724_InitialCreate.cs" name="Main" data-bi-name="code-block"><span class="hljs-keyword">public</span> <span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">InitialCreate</span> : <span class="hljs-title">Migration</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Up</span>(<span class="hljs-params">MigrationBuilder migrationBuilder</span>)
    </span>{
        migrationBuilder.CreateTable(
            name: <span class="hljs-string">"Course"</span>,
            columns: table =&gt; <span class="hljs-keyword">new</span>
            {
                CourseID = table.Column&lt;<span class="hljs-keyword">int</span>&gt;(nullable: <span class="hljs-literal">false</span>),
                Credits = table.Column&lt;<span class="hljs-keyword">int</span>&gt;(nullable: <span class="hljs-literal">false</span>),
                Title = table.Column&lt;<span class="hljs-keyword">string</span>&gt;(nullable: <span class="hljs-literal">true</span>)
            },
            constraints: table =&gt;
            {
                table.PrimaryKey(<span class="hljs-string">"PK_Course"</span>, x =&gt; x.CourseID);
            });

        <span class="hljs-comment">// Additional code not shown</span>
    }

    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">Down</span>(<span class="hljs-params">MigrationBuilder migrationBuilder</span>)
    </span>{
        migrationBuilder.DropTable(
            name: <span class="hljs-string">"Enrollment"</span>);
        <span class="hljs-comment">// Additional code not shown</span>
    }
}
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="0e97282bc799a6db39497dcd6566127d:0">Migrations calls the <code>Up</code> method to implement the data model changes for a migration. When you enter a command to roll back the update, Migrations calls the <code>Down</code> method.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0e97282bc799a6db39497dcd6566127d:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="81592dacc59cc4b33049f986632a4a73:0">This code is for the initial migration that was created when you entered the <code>migrations add InitialCreate</code> command. The migration name parameter ("InitialCreate" in the example) is used for the file name and can be whatever you want. It's best to choose a word or phrase that summarizes what is being done in the migration. For example, you might name a later migration "AddDepartmentTable".<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="81592dacc59cc4b33049f986632a4a73:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="01c46eedc799648a330d9b8f772763f5:0">If you created the initial migration when the database already exists, the database creation code is generated but it doesn't have to run because the database already matches the data model. When you deploy the app to another environment where the database doesn't exist yet, this code will run to create your database, so it's a good idea to test it first. That's why you changed the name of the database in the connection string earlier -- so that migrations can create a new one from scratch.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="01c46eedc799648a330d9b8f772763f5:0">+
</a>
</span></p>
<h2 id="examine-the-data-model-snapshot">Examine the data model snapshot</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="0b902c5fefddecdcd30b8b2727e6e254:0">Migrations also creates a <em>snapshot</em> of the current database schema in <em>Migrations/SchoolContextModelSnapshot.cs</em>. Here's what that code looks like:<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0b902c5fefddecdcd30b8b2727e6e254:0">1</a>
</span></p>
<div class="codeHeader lang-csharp" data-bi-name="code-header"><span class="language">C#</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-csharp" data-src="https://github.com/aspnet/Docs/blob/live/aspnetcore/data/ef-mvc/intro/samples/cu/Migrations/SchoolContextModelSnapshot1.cs" name="Main" data-bi-name="code-block">[<span class="hljs-meta">DbContext(typeof(SchoolContext))</span>]
<span class="hljs-keyword">partial</span> <span class="hljs-keyword">class</span> <span class="hljs-title">SchoolContextModelSnapshot</span> : <span class="hljs-title">ModelSnapshot</span>
{
    <span class="hljs-function"><span class="hljs-keyword">protected</span> <span class="hljs-keyword">override</span> <span class="hljs-keyword">void</span> <span class="hljs-title">BuildModel</span>(<span class="hljs-params">ModelBuilder modelBuilder</span>)
    </span>{
        modelBuilder
            .HasAnnotation(<span class="hljs-string">"ProductVersion"</span>, <span class="hljs-string">"2.0.0-rtm-26452"</span>)
            .HasAnnotation(<span class="hljs-string">"SqlServer:ValueGenerationStrategy"</span>, SqlServerValueGenerationStrategy.IdentityColumn);

        modelBuilder.Entity(<span class="hljs-string">"ContosoUniversity.Models.Course"</span>, b =&gt;
            {
                b.Property&lt;<span class="hljs-keyword">int</span>&gt;(<span class="hljs-string">"CourseID"</span>);

                b.Property&lt;<span class="hljs-keyword">int</span>&gt;(<span class="hljs-string">"Credits"</span>);

                b.Property&lt;<span class="hljs-keyword">string</span>&gt;(<span class="hljs-string">"Title"</span>);

                b.HasKey(<span class="hljs-string">"CourseID"</span>);

                b.ToTable(<span class="hljs-string">"Course"</span>);
            });

        <span class="hljs-comment">// Additional code for Enrollment and Student tables not shown</span>

        modelBuilder.Entity(<span class="hljs-string">"ContosoUniversity.Models.Enrollment"</span>, b =&gt;
            {
                b.HasOne(<span class="hljs-string">"ContosoUniversity.Models.Course"</span>, <span class="hljs-string">"Course"</span>)
                    .WithMany(<span class="hljs-string">"Enrollments"</span>)
                    .HasForeignKey(<span class="hljs-string">"CourseID"</span>)
                    .OnDelete(DeleteBehavior.Cascade);

                b.HasOne(<span class="hljs-string">"ContosoUniversity.Models.Student"</span>, <span class="hljs-string">"Student"</span>)
                    .WithMany(<span class="hljs-string">"Enrollments"</span>)
                    .HasForeignKey(<span class="hljs-string">"StudentID"</span>)
                    .OnDelete(DeleteBehavior.Cascade);
            });
    }
}
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="07f4aec9cdbdc4db336dc947e321cf37:0">Because the current database schema is represented in code, EF Core doesn't have to interact with the database to create migrations. When you add a migration, EF determines what changed by comparing the data model to the snapshot file. EF interacts with the database only when it has to update the database. <span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="07f4aec9cdbdc4db336dc947e321cf37:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="058cad2fe79d2003532cc98b63e14b75:0">The snapshot file has to be kept in sync with the migrations that create it, so you can't remove a migration just by deleting the file named  <em>&lt;timestamp&gt;_&lt;migrationname&gt;.cs</em>. If you delete that file, the remaining migrations will be out of sync with the database snapshot file. To delete the last migration that you added, use the <a href="https://docs.microsoft.com/ef/core/miscellaneous/cli/dotnet#dotnet-ef-migrations-remove" data-linktype="external">dotnet ef migrations remove</a> command.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="058cad2fe79d2003532cc98b63e14b75:0">2</a>
</span></p>
<h2 id="apply-the-migration-to-the-database">Apply the migration to the database</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="0784ac6dd7b82e13300dbc675b424355:0">In the command window, enter the following command to create the database and tables in it.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0784ac6dd7b82e13300dbc675b424355:0">2</a>
</span></p>
<div class="codeHeader lang-console" data-bi-name="code-header"><span class="language">console</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-console" data-bi-name="code-block">dotnet ef database update
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="0dccaceb4fbd665b398db847e7234b57:0">The output from the command is similar to the <code>migrations add</code> command, except that you see logs for the SQL commands that set up the database. Most of the logs are omitted in the following sample output. If you prefer not to see this level of detail in log messages, you can change the log levels in the <em>appsettings.Development.json</em> file. For more information, see <a class="xref" href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/logging" data-linktype="relative-path">Introduction to logging</a>.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0dccaceb4fbd665b398db847e7234b57:0">+
</a>
</span></p>
<div class="codeHeader lang-text" data-bi-name="code-header"><span class="language">text</span><button class="action copy" data-bi-name="copy"><span>Copy</span></button></div><pre><code class="lang-text" data-bi-name="code-block">info: <span class="hljs-symbol">Microsoft</span>.<span class="hljs-symbol">AspNetCore</span>.<span class="hljs-symbol">DataProtection</span>.<span class="hljs-symbol">KeyManagement</span>.<span class="hljs-symbol">XmlKeyManager</span>[<span class="hljs-number">0</span>]
      <span class="hljs-symbol">User</span> profile is available. <span class="hljs-symbol">Using</span> <span class="hljs-string">'C:\Users\username\AppData\Local\ASP.NET\DataProtection-Keys'</span> as key repository and <span class="hljs-symbol">Windows</span> <span class="hljs-symbol">DPAPI</span> to encrypt keys at rest.
info: <span class="hljs-symbol">Microsoft</span>.<span class="hljs-symbol">EntityFrameworkCore</span>.<span class="hljs-symbol">Infrastructure</span>[<span class="hljs-number">100403</span>]
      <span class="hljs-symbol">Entity</span> <span class="hljs-symbol">Framework</span> <span class="hljs-symbol">Core</span> <span class="hljs-number">2.0</span><span class="hljs-number">.0</span>-rtm<span class="hljs-number">-26452</span> initialized <span class="hljs-string">'SchoolContext'</span> using provider <span class="hljs-string">'Microsoft.EntityFrameworkCore.SqlServer'</span> with options: <span class="hljs-symbol">None</span>
info: <span class="hljs-symbol">Microsoft</span>.<span class="hljs-symbol">EntityFrameworkCore</span>.<span class="hljs-symbol">Database</span>.<span class="hljs-symbol">Command</span>[<span class="hljs-number">200101</span>]
      <span class="hljs-symbol">Executed</span> <span class="hljs-symbol">DbCommand</span> (<span class="hljs-number">467</span>ms) [<span class="hljs-symbol">Parameters</span>=[], <span class="hljs-symbol">CommandType</span>=<span class="hljs-string">'Text'</span>, <span class="hljs-symbol">CommandTimeout</span>=<span class="hljs-string">'60'</span>]
      <span class="hljs-symbol">CREATE</span> <span class="hljs-symbol">DATABASE</span> [<span class="hljs-symbol">ContosoUniversity2</span>];
info: <span class="hljs-symbol">Microsoft</span>.<span class="hljs-symbol">EntityFrameworkCore</span>.<span class="hljs-symbol">Database</span>.<span class="hljs-symbol">Command</span>[<span class="hljs-number">200101</span>]
      <span class="hljs-symbol">Executed</span> <span class="hljs-symbol">DbCommand</span> (<span class="hljs-number">20</span>ms) [<span class="hljs-symbol">Parameters</span>=[], <span class="hljs-symbol">CommandType</span>=<span class="hljs-string">'Text'</span>, <span class="hljs-symbol">CommandTimeout</span>=<span class="hljs-string">'30'</span>]
      <span class="hljs-symbol">CREATE</span> <span class="hljs-symbol">TABLE</span> [<span class="hljs-symbol">__EFMigrationsHistory</span>] (
          [<span class="hljs-symbol">MigrationId</span>] nvarchar(<span class="hljs-number">150</span>) <span class="hljs-symbol">NOT</span> <span class="hljs-symbol">NULL</span>,
          [<span class="hljs-symbol">ProductVersion</span>] nvarchar(<span class="hljs-number">32</span>) <span class="hljs-symbol">NOT</span> <span class="hljs-symbol">NULL</span>,
          <span class="hljs-symbol">CONSTRAINT</span> [<span class="hljs-symbol">PK___EFMigrationsHistory</span>] <span class="hljs-symbol">PRIMARY</span> <span class="hljs-symbol">KEY</span> ([<span class="hljs-symbol">MigrationId</span>])
      );

&lt;logs omitted for brevity&gt;

info: <span class="hljs-symbol">Microsoft</span>.<span class="hljs-symbol">EntityFrameworkCore</span>.<span class="hljs-symbol">Database</span>.<span class="hljs-symbol">Command</span>[<span class="hljs-number">200101</span>]
      <span class="hljs-symbol">Executed</span> <span class="hljs-symbol">DbCommand</span> (<span class="hljs-number">3</span>ms) [<span class="hljs-symbol">Parameters</span>=[], <span class="hljs-symbol">CommandType</span>=<span class="hljs-string">'Text'</span>, <span class="hljs-symbol">CommandTimeout</span>=<span class="hljs-string">'30'</span>]
      <span class="hljs-symbol">INSERT</span> <span class="hljs-symbol">INTO</span> [<span class="hljs-symbol">__EFMigrationsHistory</span>] ([<span class="hljs-symbol">MigrationId</span>], [<span class="hljs-symbol">ProductVersion</span>])
      <span class="hljs-symbol">VALUES</span> (<span class="hljs-symbol">N</span><span class="hljs-string">'20170816151242_InitialCreate'</span>, <span class="hljs-symbol">N</span><span class="hljs-string">'2.0.0-rtm-26452'</span>);
<span class="hljs-symbol">Done</span>.
</code></pre><p class="lf-text-block lf-block" data-lf-anchor-id="8bd4ec6557b9209b3ba9fa436b024b51:0">Use <strong>SQL Server Object Explorer</strong> to inspect the database as you did in the first tutorial.  You'll notice the addition of an __EFMigrationsHistory table that keeps track of which migrations have been applied to the database. View the data in that table and you'll see one row for the first migration. (The last log in the preceding CLI output example shows the INSERT statement that creates this row.)<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8bd4ec6557b9209b3ba9fa436b024b51:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="2144244f75bc5637eb6ca9ce7183e157:0">Run the application to verify that everything still works the same as before.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="2144244f75bc5637eb6ca9ce7183e157:0">1</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="d41d8cd98f00b204e9800998ecf8427e:0"><img src="./Migrations_files/students-index.png" alt="Students Index page" data-linktype="relative-path"><span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="d41d8cd98f00b204e9800998ecf8427e:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="d41d8cd98f00b204e9800998ecf8427e:1"><a id="pmc"></a><span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="d41d8cd98f00b204e9800998ecf8427e:1">+
</a>
</span></p>
<h2 id="command-line-interface-cli-vs-package-manager-console-pmc">Command-line interface (CLI) vs. Package Manager Console (PMC)</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="0f904caf4ebaa2ce430ddc6247027b5b:0">The EF tooling for managing migrations is available from .NET Core CLI commands or from PowerShell cmdlets in the Visual Studio <strong>Package Manager Console</strong> (PMC) window. This tutorial shows how to use the CLI, but you can use the PMC if you prefer.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0f904caf4ebaa2ce430ddc6247027b5b:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="0f972ca647bceec23b89cd1b47277fdb:0">The EF commands for the PMC commands are in the <a href="https://www.nuget.org/packages/Microsoft.EntityFrameworkCore.Tools" data-linktype="external">Microsoft.EntityFrameworkCore.Tools</a> package. This package is already included in the <a class="xref" href="https://docs.microsoft.com/en-us/aspnet/core/fundamentals/metapackage" data-linktype="relative-path">Microsoft.AspNetCore.All</a> metapackage, so you don't have to install it.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0f972ca647bceec23b89cd1b47277fdb:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="8b80282e461b66da5b088807672f07d3:0"><strong>Important:</strong> This is not the same package as the one you install for the CLI by editing the <em>.csproj</em> file. The name of this one ends in <code>Tools</code>, unlike the CLI package name which ends in <code>Tools.DotNet</code>.<span class="lf-has-num lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="8b80282e461b66da5b088807672f07d3:0">1</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="0fdac00f90dc70f79bcdddc084174e6e:0">For more information about the CLI commands, see <a href="https://docs.microsoft.com/ef/core/miscellaneous/cli/dotnet" data-linktype="external">.NET Core CLI</a>. <span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="0fdac00f90dc70f79bcdddc084174e6e:0">+
</a>
</span></p>
<p class="lf-text-block lf-block" data-lf-anchor-id="9fce488a464a45e60fcdcd1ae7525b94:0">For more information about the PMC commands, see <a href="https://docs.microsoft.com/ef/core/miscellaneous/cli/powershell" data-linktype="external">Package Manager Console (Visual Studio)</a>.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="9fce488a464a45e60fcdcd1ae7525b94:0">+
</a>
</span></p>
<h2 id="summary">Summary</h2>
<p class="lf-text-block lf-block" data-lf-anchor-id="4f940ae9c7b964aeb1cd3d8c5b612f5c:0">In this tutorial, you've seen how to create and apply your first migration. In the next tutorial, you'll begin looking at more advanced topics by expanding the data model. Along the way you'll create and apply additional migrations.<span class="lf-thread-btn"><a class="fycon-action-view" tabindex="0" aria-label="Write a Sidenote" data-lf-anchor-id="4f940ae9c7b964aeb1cd3d8c5b612f5c:0">+
</a>
</span></p>

</div></div>
 

						<div id="comments-container" ms.cmpgrp="comments" data-bi-name="comments" role="form"><div class="fyre fyre-width-medium"></div></div>
				</div>
		</main>

		

		

		

		

	</div>

	<div id="openFeedbackContainer" class="openfeedback-container footer-layout or-t-ml or-pc" style="z-index: 1000;"><button type="button" role="button" class="or-b or-c-mv or-o or-f" style="opacity: 1;"></button></div>

	<div class="container footerContainer">
	</div>

	<script src="./Migrations_files/b11234fb1603062af431.conceptual.js.descarga"></script>

<script src="./Migrations_files/ms.js.descarga" async="" defer=""></script><script src="./Migrations_files/Livefyre.js.descarga" async="" defer=""></script><script src="./Migrations_files/open-commenting.entry.min.js.descarga" async="" defer=""></script><link rel="stylesheet" type="text/css" href="./Migrations_files/open-commenting.ui.v1.0.2-7-g1b78816.master.min.css"><link rel="stylesheet" type="text/css" href="./Migrations_files/open-commenting.ui.docs.v1.0.2-7-g1b78816.master.min.css"><script type="text/javascript" src="./Migrations_files/open-rating.ui-v0.6.1-97-g14612aa.master.min.js.descarga"></script><div id="fyre-messenger-1"></div><div style="position: absolute; display: none;"><div class="tooltip">aaronisaacm</div><div class="arrow-down"></div></div><div class="fyre-hovercard" style="display: none;"><div class="fyre-hovercard-body"></div><div class="fyre-hovercard-arrow"></div></div></body></html>